<%= simple_form_for @requisicao,html: {class: 'well form-horizontal'},url: agendar_requisicao_requisicoes_url do |f| %>
<%= f.error_notification %>
    <%= f.input :motivo,:label=>"Motivo da Requisição" %>
    <%= f.input :requisitante_id,input_html: {value: current_user.pessoa.id},as: :hidden%>
    <%=f.input :inicio,:input_html=>{:readonly=>true},as: :string,hint: "Clique no campo para selecionar a data de Ida e Volta"%>
    <%=f.input :fim,:input_html=>{:readonly=>true},as: :string,hint: "Este campo será preenchido automaticamente"%>
<%=f.input :rota_ids,:collection=>@rotas.collect{|r|[r.destino,r.id]},input_html: {class: "multiselect_rota",multiple: "multiple"},:hint=>"Selecione a Rota desejada",:label=>"Rota Desejada"%>

<%=f.input :pessoa_ids,:collection=>@pessoas.collect{|p|[p.nome,p.id]},input_html: {class: "multiselect_pessoa",multiple: "multiple"},:hint=>"Selecione as Pessoas",:label=>"Pessoas incluídas"%>
<br/><br/><br/>
    <%=botoes_form(f)%>

<% end %>


<script type="text/javascript">
$('#requisicao_inicio').daterangepicker(
    {
    locale: {applyLabel: 'Aplicar',
                cancelLabel: 'Cancel',
                fromLabel: 'De',
                toLabel: 'Até',
                weekLabel: 'W',
                customRangeLabel: 'Calendário'},
                timePicker: true, timePickerIncrement: 15, format: 'DD/MM/YYYY H:mm',timePicker12Hour: false,

      startDate: moment(),
      endDate: moment().add('minutes',15)
    },
    function(start, end) {
        $('#requisicao_inicio').val(start.format('DD/MM/YYYY H:mm'));
        $('#requisicao_fim').val(end.format('DD/MM/YYYY H:mm'));
    }
);
</script>



<script type="text/javascript">
  $(document).ready(function() {
    $('.multiselect_pessoa').multiselect({
      enableFiltering: true,
      nonSelectedText: 'Nenhuma pessoa Selecionada',
      onChange: function(option, checked) {
    // Get selected options.
    var selectedOptions = $('.multiselect_pessoa option:selected');

    if (selectedOptions.length >= 5) {
    // Disable all other checkboxes.
    var nonSelectedOptions = $('.multiselect_pessoa option').filter(function() {
      return !$(this).is(':selected');
    });

    var dropdown = $('.multiselect_pessoa').siblings('.multiselect-container');
    nonSelectedOptions.each(function() {
      var input = $('input[value="' + $(this).val() + '"]');
      input.prop('disabled', true);
      input.parent('li').addClass('disabled');
    });
}
else {
    // Enable all checkboxes.
    var dropdown = $('.multiselect_pessoa').siblings('.multiselect-container');
    $('.multiselect_pessoa option').each(function() {
      var input = $('input[value="' + $(this).val() + '"]');
      input.prop('disabled', false);
      input.parent('li').addClass('disabled');
    });
}
}
});
    $('.multiselect_rota').multiselect({
      enableFiltering: true,
       nonSelectedText: 'Selecione ao Menos uma Rota'
    });
  });
</script>
